{"id":"9ffeec64-14d1-4520-b4b5-2061a9abc015","code":"catch_with_index_or_dlq","document_type":"node_type","data":{"code":"catch_with_index_or_dlq","name":"Catch with Index or DLQ","group":"Flujo","react_component_type":"AngieInputNode","custom_color":false,"json_data_schema":"{\n    \"type\": \"object\",\n    \"required\": [\n        \"label\",\n        \"elasticInstanceName\",\n        \"elasticIndex\",\n        \"dlqQueueName\"\n    ],\n    \"properties\": {\n        \"label\": {\n            \"type\": \"string\"\n        },\n        \"showCaughtException\": {\n            \"title\": \"Show exception message\",\n            \"type\": \"boolean\"\n        },\n        \"showStackTrace\": {\n            \"title\": \"Show stack trace\",\n            \"type\": \"boolean\"\n        },\n        \"multiline\": {\n            \"title\": \"Show error in multiline\",\n            \"type\": \"boolean\"\n        },\n        \"indexOnElastic\": {\n            \"title\": \"Index on elastic\",\n            \"type\": \"boolean\"\n        },\n        \"elasticInstanceName\": {\n            \"title\": \"Elastic Instance name\",\n            \"type\": \"string\"\n        },\n        \"elasticIndex\": {\n            \"title\": \"Elastic Index\",\n            \"type\": \"string\"\n        },\n        \"dlqQueueName\": {\n            \"title\": \"DLQ queue name\",\n            \"type\": \"string\"\n        },\n        \"dlqHostname\": {\n            \"title\": \"DLQ Host\",\n            \"type\": \"string\"\n        },\n        \"dlqPort\": {\n            \"title\": \"DLQ Port\",\n            \"type\": \"string\"\n        },\n        \"dlqUsername\": {\n            \"title\": \"DLQ User\",\n            \"type\": \"string\"\n        },\n        \"dlqPassword\": {\n            \"title\": \"DQL Password\",\n            \"type\": \"string\"\n        },\n        \"dlqSslProtocol\": {\n            \"title\": \"DLQ SSL Protocol\",\n            \"type\": \"string\"\n        }\n    }\n}","json_ui_schema":"{\n    \"ui:classNames\": \"row\",\n    \"label\": {\n        \"ui:classNames\": \"col-12\"\n    },\n    \"showCaughtException\": {\n        \"ui:widget\": \"checkbox\",\n        \"ui:classNames\": \"col-3\"\n    },\n    \"showStackTrace\": {\n        \"ui:widget\": \"checkbox\",\n        \"ui:classNames\": \"col-3\"\n    },\n    \"multiline\": {\n        \"ui:widget\": \"checkbox\",\n        \"ui:classNames\": \"col-3\"\n    },\n    \"indexOnElastic\": {\n        \"ui:widget\": \"checkbox\",\n        \"ui:classNames\": \"col-3\"\n    },\n    \"elasticInstanceName\": {\n        \"condition\": \"indexOnElastic=true\",\n        \"ui:classNames\": \"col-4\"\n    },\n    \"elasticIndex\": {\n        \"condition\": \"indexOnElastic=true\",\n        \"ui:classNames\": \"col-5\"\n    },\n    \"dlqQueueName\": {\n        \"ui:classNames\": \"col-4\",\n        \"ui:help\": \"In case of error indexing on Elastic or not indexing in Elastic, the message will be sent to DLQ.\"\n    },\n    \"dlqHostname\": {\n        \"ui:classNames\": \"col-4\"\n    },\n    \"dlqPort\": {\n        \"ui:classNames\": \"col-4\"\n    },\n    \"dlqUsername\": {\n        \"ui:classNames\": \"col-4\"\n    },\n    \"dlqPassword\": {\n        \"ui:classNames\": \"col-4\"\n    },\n    \"dlqSslProtocol\": {\n        \"ui:classNames\": \"col-4\"\n    }\n}","xml_template":"<route  id=\"{{source}}\">\n    <from uri=\"direct:{{source}}\"/>\n    <to uri=\"log:error?level=ERROR&amp;showCaughtException={{showCaughtException}}&amp;showStackTrace={{showStackTrace}}&amp;multiline={{multiline}}\" />\n    {{#if (eq indexOnElastic true)}}\n    <doTry>\n        <unmarshal>\n            <json/>\n        </unmarshal>\n        <toD uri=\"{{elasticInstanceName}}://elasticsearch?indexName={{elasticIndex}}&amp;operation=Index\"/>\n        <doCatch>\n            <exception>\n                java.lang.Exception\n            </exception>\n            <to uri=\"log:error?level=ERROR&amp;showCaughtException=true&amp;multiline=true\" />\n            <removeHeaders pattern=\"CamelRabbit*\"/>\n            <toD uri=\"rabbitmq://{{source}}?channelPoolMaxSize=10&amp;channelPoolMaxWait=1000&amp;guaranteedDeliveries=false&amp;passive=false&amp;autoDelete=false&amp;exchangePattern=InOnly&amp;username={{dlqUsername}}&amp;password={{dlqPassword}}&amp;routingKey={{dlqQueueName}}&amp;queue={{dlqQueueName}}&amp;addresses={{dlqHostname}}:{{dlqPort}}{{dlqSslProtocol}}\"/>\n        </doCatch>\n        <doFinally>\n            {{applyMarshal output_format output_format_options}}\n            {{generateDestination target}}\n        </doFinally>\n    </doTry>\n    {{/if}}\n    \n    {{#if (eq indexOnElastic false)}}\n    <removeHeaders pattern=\"CamelRabbit*\"/>\n    <toD uri=\"rabbitmq://{{source}}?channelPoolMaxSize=10&amp;channelPoolMaxWait=1000&amp;guaranteedDeliveries=false&amp;passive=false&amp;autoDelete=false&amp;exchangePattern=InOnly&amp;username={{dlqUsername}}&amp;password={{dlqPassword}}&amp;routingKey={{dlqQueueName}}&amp;queue={{dlqQueueName}}&amp;addresses={{dlqHostname}}:{{dlqPort}}{{dlqSslProtocol}}\"/>\n    {{applyMarshal output_format output_format_options}}\n        {{generateDestination target}}\n    {{/if}}\n</route>","defaults":"{\n    \"showCaughtException\": true,\n    \"showStackTrace\": true,\n    \"multiline\": true,\n    \"indexOnElastic\": true,\n    \"output_format\": \"raw\",\n    \"dlqHostname\": \"{{GLOBAL:RMQ_URL}}\",\n    \"dlqPort\": \"{{GLOBAL:RMQ_PORT}}\",\n    \"dlqUsername\": \"{{GLOBAL:RMQ_USER}}\",\n    \"dlqPassword\": \"{{GLOBAL:RMQ_PASS}}\",\n    \"dlqSslProtocol\": \"{{GLOBAL:RMQ_SSL_PROTOCOL}}\"\n}","id":"9ffeec64-14d1-4520-b4b5-2061a9abc015","filename":"catch_with_index.json"},"package_code":null,"package_version":null}